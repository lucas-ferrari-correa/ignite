(()=>{"use strict";var e={842:(e,t,r)=>{r.d(t,{t:()=>o});var a=r(336);const o=process.env.IS_OFFLINE?new a.DynamoDB.DocumentClient({region:"localhost",endpoint:"http://localhost:8000"}):new a.DynamoDB.DocumentClient},336:e=>{e.exports=require("aws-sdk")},893:e=>{e.exports=require("chrome-aws-lambda")},635:e=>{e.exports=require("dayjs")},97:e=>{e.exports=require("handlebars")},147:e=>{e.exports=require("fs")},17:e=>{e.exports=require("path")}},t={};function r(a){var o=t[a];if(void 0!==o)return o.exports;var s=t[a]={exports:{}};return e[a](s,s.exports,r),s.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var a={};(()=>{r.r(a),r.d(a,{handle:()=>m});var e=r(893),t=r.n(e),o=r(17),s=r.n(o),i=r(97),n=r.n(i),c=r(147),p=r.n(c),d=r(635),l=r.n(d),u=r(336),f=r(842);const m=async e=>{const{id:r,name:a,grade:o}=JSON.parse(e.body);(await f.t.query({TableName:"users_certificates",KeyConditionExpression:"id = :id",ExpressionAttributeValues:{":id":r}}).promise()).Items[0]||await f.t.put({TableName:"users_certificates",Item:{id:r,name:a,grade:o}}).promise();const i=s().join(process.cwd(),"src","templates","selo.png"),c=p().readFileSync(i,"base64"),d={date:l()().format("DD/MM/YYYY"),grade:o,name:a,id:r,medal:c},m=await async function(e){const t=s().join(process.cwd(),"src","templates","certificate.hbs"),r=p().readFileSync(t,"utf-8");return n().compile(r)(e)}(d),y=await t().puppeteer.launch({headless:!0,args:t().args,defaultViewport:t().defaultViewport,executablePath:await t().executablePath}),b=await y.newPage();await b.setContent(m);const w=await b.pdf({format:"a4",landscape:!0,path:process.env.IS_OFFLINE?"certificate.pdf":null,printBackground:!0,preferCSSPageSize:!0});await y.close();const g=new u.S3;return await g.putObject({Bucket:"ignitecertificate-lucasferraricorrea-2",Key:`${r}.pdf`,ACL:"public-read",Body:w,ContentType:"application/pdf"}).promise(),{statusCode:201,body:JSON.stringify({message:"Certificate created!",url:`https://ignitecertificate-lucasferraricorrea-2.s3.amazonaws.com/${r}.pdf`}),headers:{"Content-type":"application/json"}}}})();var o=exports;for(var s in a)o[s]=a[s];a.__esModule&&Object.defineProperty(o,"__esModule",{value:!0})})();
//# sourceMappingURL=generateCertificate.js.map